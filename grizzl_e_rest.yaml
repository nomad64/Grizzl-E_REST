# Grizzl-E Local Status Data
# This configuration polls the Grizzl-E Ultimate charger's local API for state information and metrics.
- resource: !secret grizzl_e_main_resource # Define this in secrets.yaml as: grizzl_e_main_resource: http://<ipaddress>/main
  method: POST
  scan_interval: 10 # Adjusted to 10 seconds to avoid overwhelming the local API
  sensor:
    - name: grizzl_e_fw_main
      value_template: "{{ value_json.verFWMain }}"
      unique_id: grizzl_e_fw_main

    - name: grizzl_e_fw_wifi
      value_template: "{{ value_json.verFWWifi }}"
      unique_id: grizzl_e_fw_wifi

    - name: grizzl_e_serial_num_cpu
      value_template: "{{ value_json.serialNumCPU }}"
      unique_id: grizzl_e_serial_num_cpu

    - name: grizzl_e_serial_num
      value_template: "{{ value_json.serialNum }}"
      unique_id: grizzl_e_serial_num

    - name: grizzl_e_station_id
      value_template: "{{ value_json.stationId }}"
      unique_id: grizzl_e_station_id

    - name: grizzl_e_fw_crc32
      value_template: "{{ value_json.fwCRC32 }}"
      unique_id: grizzl_e_fw_crc32

    - name: grizzl_e_broadcast_mode
      value_template: "{{ value_json.broadcastMode }}"
      unique_id: grizzl_e_broadcast_mode

    - name: grizzl_e_switch_state
      value_template: "{{ value_json.switchState }}"
      unique_id: grizzl_e_switch_state

    - name: grizzl_e_fw_status
      value_template: "{{ value_json.verFWStatus }}"
      unique_id: grizzl_e_fw_status

    - name: grizzl_e_pilot
      value_template: "{{ value_json.pilot }}"
      unique_id: grizzl_e_pilot

    - name: grizzl_e_state
      value_template: "{{ value_json.state }}"
      unique_id: grizzl_e_state

    - name: grizzl_e_sub_state
      value_template: "{{ value_json.subState }}"
      unique_id: grizzl_e_sub_state

    - name: grizzl_e_current_set
      value_template: "{{ value_json.currentSet }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_current_set

    - name: grizzl_e_cur_design
      value_template: "{{ value_json.curDesign }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_cur_design

    - name: grizzl_e_min_current
      value_template: "{{ value_json.minCurrent }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_min_current

    - name: grizzl_e_min_voltage
      value_template: "{{ value_json.minVoltage }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_min_voltage

    - name: grizzl_e_grid_range
      value_template: "{{ value_json.gridRange }}"
      unique_id: grizzl_e_grid_range

    - name: grizzl_e_type_evse
      value_template: "{{ value_json.typeEvse }}"
      unique_id: grizzl_e_type_evse

    - name: grizzl_e_type_relay
      value_template: "{{ value_json.typeRelay }}"
      unique_id: grizzl_e_type_relay

    - name: grizzl_e_ai_mode_current
      value_template: "{{ value_json.aiModecurrent }}"
      unique_id: grizzl_e_ai_mode_current

    - name: grizzl_e_ai_status
      value_template: "{{ value_json.aiStatus }}"
      unique_id: grizzl_e_ai_status

    - name: grizzl_e_ai_voltage
      value_template: "{{ value_json.aiVoltage }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_ai_voltage

    - name: grizzl_e_ai_voltage_start
      value_template: "{{ value_json.aiVoltageStart }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_ai_voltage_start

    - name: grizzl_e_ai_voltage_drop
      value_template: "{{ value_json.aiVoltageDrop }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_ai_voltage_drop

    - name: grizzl_e_ai_power_drop
      value_template: "{{ value_json.aiPowerDrop }}"
      unique_id: grizzl_e_ai_power_drop

    - name: grizzl_e_sn_flag
      value_template: "{{ value_json.SNflag }}"
      unique_id: grizzl_e_sn_flag

    - name: grizzl_e_ground
      value_template: "{{ value_json.ground }}"
      unique_id: grizzl_e_ground

    - name: grizzl_e_ground_ctrl
      value_template: "{{ value_json.groundCtrl }}"
      unique_id: grizzl_e_ground_ctrl

    - name: grizzl_e_tarif
      value_template: "{{ value_json.tarif }}"
      unique_id: grizzl_e_tarif

    - name: grizzl_e_active_tarif
      value_template: "{{ value_json.activeTarif }}"
      unique_id: grizzl_e_active_tarif

    - name: grizzl_e_tarif_a_value
      value_template: "{{ value_json.tarifAValue }}"
      unique_id: grizzl_e_tarif_a_value

    - name: grizzl_e_tarif_b_value
      value_template: "{{ value_json.tarifBValue }}"
      unique_id: grizzl_e_tarif_b_value

    - name: grizzl_e_tarif_a_start
      value_template: "{{ value_json.tarifAStart }}"
      unique_id: grizzl_e_tarif_a_start

    - name: grizzl_e_tarif_a_stop
      value_template: "{{ value_json.tarifAStop }}"
      unique_id: grizzl_e_tarif_a_stop

    - name: grizzl_e_tarif_b_stop
      value_template: "{{ value_json.tarifBStop }}"
      unique_id: grizzl_e_tarif_b_stop

    - name: grizzl_e_timer_type
      value_template: "{{ value_json.timerType }}"
      unique_id: grizzl_e_timer_type

    - name: grizzl_e_time_zone
      value_template: "{{ value_json.timeZone }}"
      unique_id: grizzl_e_time_zone

    - name: grizzl_e_system_time
      value_template: "{{ value_json.systemTime }}"
      unique_id: grizzl_e_system_time

    - name: grizzl_e_time_msg
      value_template: "{{ value_json.timeMsg }}"
      unique_id: grizzl_e_time_msg

    - name: grizzl_e_time_limit_s
      value_template: "{{ value_json.timeLimitS }}"
      unique_id: grizzl_e_time_limit_s

    - name: grizzl_e_energy_limit_s
      value_template: "{{ value_json.energyLimitS }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total
      unique_id: grizzl_e_energy_limit_s

    - name: grizzl_e_money_limit_s
      value_template: "{{ value_json.moneyLimitS }}"
      unique_id: grizzl_e_money_limit_s

    - name: grizzl_e_delayed_limit
      value_template: "{{ value_json.delayedLimit }}"
      unique_id: grizzl_e_delayed_limit

    - name: grizzl_e_time_limit
      value_template: "{{ value_json.timeLimit }}"
      unique_id: grizzl_e_time_limit

    - name: grizzl_e_energy_limit
      value_template: "{{ value_json.energyLimit }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total
      unique_id: grizzl_e_energy_limit

    - name: grizzl_e_money_limit
      value_template: "{{ value_json.moneyLimit }}"
      unique_id: grizzl_e_money_limit

    - name: grizzl_e_sh1_start
      value_template: "{{ value_json.sh1Start }}"
      unique_id: grizzl_e_sh1_start

    - name: grizzl_e_sh1_stop
      value_template: "{{ value_json.sh1Stop }}"
      unique_id: grizzl_e_sh1_stop

    - name: grizzl_e_sh1_current_value
      value_template: "{{ value_json.sh1CurrentValue }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_sh1_current_value

    - name: grizzl_e_sh1_energy_value
      value_template: "{{ value_json.sh1EnergyValue }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total
      unique_id: grizzl_e_sh1_energy_value

    - name: grizzl_e_sh2_start
      value_template: "{{ value_json.sh2Start }}"
      unique_id: grizzl_e_sh2_start

    - name: grizzl_e_sh2_stop
      value_template: "{{ value_json.sh2Stop }}"
      unique_id: grizzl_e_sh2_stop

    - name: grizzl_e_sh2_current_value
      value_template: "{{ value_json.sh2CurrentValue }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_sh2_current_value

    - name: grizzl_e_sh2_energy_value
      value_template: "{{ value_json.sh2EnergyValue }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total
      unique_id: grizzl_e_sh2_energy_value

    - name: grizzl_e_total_energy
      value_template: "{{ value_json.totalEnergy }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total_increasing
      unique_id: grizzl_e_total_energy

    - name: grizzl_e_session_time
      value_template: "{{ value_json.sessionTime }}"
      unique_id: grizzl_e_session_time

    - name: grizzl_e_session_energy
      value_template: "{{ value_json.sessionEnergy }}"
      device_class: energy
      unit_of_measurement: "kWh"
      state_class: total
      unique_id: grizzl_e_session_energy

    - name: grizzl_e_session_money
      value_template: "{{ value_json.sessionMoney }}"
      unique_id: grizzl_e_session_money

    - name: grizzl_e_iem1
      value_template: "{{ value_json.IEM1 }}"
      unique_id: grizzl_e_iem1

    - name: grizzl_e_iem2
      value_template: "{{ value_json.IEM2 }}"
      unique_id: grizzl_e_iem2

    - name: grizzl_e_iem1_money
      value_template: "{{ value_json.IEM1_money }}"
      unique_id: grizzl_e_iem1_money

    - name: grizzl_e_iem2_money
      value_template: "{{ value_json.IEM2_money }}"
      unique_id: grizzl_e_iem2_money

    - name: grizzl_e_cur_meas1
      value_template: "{{ value_json.curMeas1 }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_cur_meas1

    - name: grizzl_e_cur_meas2
      value_template: "{{ value_json.curMeas2 }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_cur_meas2

    - name: grizzl_e_cur_meas3
      value_template: "{{ value_json.curMeas3 }}"
      device_class: current
      unit_of_measurement: "A"
      state_class: measurement
      unique_id: grizzl_e_cur_meas3

    - name: grizzl_e_volt_meas1
      value_template: "{{ value_json.voltMeas1 }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_volt_meas1

    - name: grizzl_e_volt_meas2
      value_template: "{{ value_json.voltMeas2 }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_volt_meas2

    - name: grizzl_e_volt_meas3
      value_template: "{{ value_json.voltMeas3 }}"
      device_class: voltage
      unit_of_measurement: "V"
      state_class: measurement
      unique_id: grizzl_e_volt_meas3

    - name: grizzl_e_power_meas
      value_template: "{{ value_json.powerMeas }}"
      device_class: power
      unit_of_measurement: "W"
      state_class: measurement
      unique_id: grizzl_e_power_meas

    - name: grizzl_e_temperature1
      value_template: "{{ value_json.temperature1 }}"
      unique_id: grizzl_e_temperature1

    - name: grizzl_e_temperature2
      value_template: "{{ value_json.temperature2 }}"
      unique_id: grizzl_e_temperature1

    - name: grizzl_e_leak_value
      value_template: "{{ value_json.leakValue }}"
      unique_id: grizzl_e_leak_value

    - name: grizzl_e_leak_value_h
      value_template: "{{ value_json.leakValueH }}"
      unique_id: grizzl_e_leak_value_h

    - name: grizzl_e_v_bat
      value_template: "{{ value_json.vBat }}"
      unique_id: grizzl_e_v_bat

    - name: grizzl_e_adapter
      value_template: "{{ value_json.adapter }}"
      unique_id: grizzl_e_adapter

    - name: grizzl_e_lang
      value_template: "{{ value_json.lang }}"
      unique_id: grizzl_e_lang

    - name: grizzl_e_ocpp_connected
      value_template: "{{ value_json.ocppconnected }}"
      unique_id: grizzl_e_ocpp_connected

    - name: grizzl_e_ocpp_vendor
      value_template: "{{ value_json.ocppVendor }}"
      unique_id: grizzl_e_ocpp_vendor

    - name: grizzl_e_sta_ip_address
      value_template: "{{ value_json.STA_IP_Addres }}"
      unique_id: grizzl_e_sta_ip_address

    - name: grizzl_e_rssi
      value_template: "{{ value_json.RSSI }}"
      unique_id: grizzl_e_rssi

    - name: grizzl_e_model
      value_template: "{{ value_json.model }}"
      unique_id: grizzl_e_model

  binary_sensor:
    - name: grizzl_e_log_ready
      value_template: "{{ value_json.logReady }}"
      unique_id: grizzl_e_log_ready

    - name: grizzl_e_ocpp_enabled
      value_template: "{{ value_json.ocppEnabled }}"
      unique_id: grizzl_e_ocpp_enabled

    - name: grizzl_e_session_started
      value_template: "{{ value_json.sessionStarted }}"
      unique_id: grizzl_e_session_started

    - name: grizzl_e_tarif_a_enable
      value_template: "{{ value_json.tarifAEnable }}"
      unique_id: grizzl_e_tarif_a_enable

    - name: grizzl_e_tarif_b_enable
      value_template: "{{ value_json.tarifBEnable }}"
      unique_id: grizzl_e_tarif_b_enable

    - name: grizzl_e_evse_enabled
      value_template: "{{ value_json.evseEnabled }}"
      unique_id: grizzl_e_evse_enabled

    - name: grizzl_e_sh1_enabled
      value_template: "{{ value_json.sh1Enabled }}"
      unique_id: grizzl_e_sh1_enabled

    - name: grizzl_e_sh1_current_enable
      value_template: "{{ value_json.sh1CurrentEnable }}"
      unique_id: grizzl_e_sh1_current_enable

    - name: grizzl_e_sh1_energy_enable
      value_template: "{{ value_json.sh1EnergyEnable }}"
      unique_id: grizzl_e_sh1_energy_enable

    - name: grizzl_e_sh2_enabled
      value_template: "{{ value_json.sh2Enabled }}"
      unique_id: grizzl_e_sh2_enabled

    - name: grizzl_e_sh2_current_enable
      value_template: "{{ value_json.sh2CurrentEnable }}"
      unique_id: grizzl_e_sh2_current_enable

    - name: grizzl_e_sh2_energy_enable
      value_template: "{{ value_json.sh2EnergyEnable }}"
      unique_id: grizzl_e_sh2_energy_enable

    - name: grizzl_e_ocpp_offline_ava
      value_template: "{{ value_json.ocppOfflineAva }}"
      unique_id: grizzl_e_ocpp_offline_ava

    - name: grizzl_e_scan_complete
      value_template: "{{ value_json.scanComplete }}"
      unique_id: grizzl_e_scan_complete

    - name: grizzl_e_suspend_errors
      value_template: "{{ value_json.suspendErrors }}"
      unique_id: grizzl_e_suspend_errors

    - name: grizzl_e_suspend_limits
      value_template: "{{ value_json.suspendLimits }}"
      unique_id: grizzl_e_suspend_limits

    - name: grizzl_e_one_charge
      value_template: "{{ value_json.oneCharge }}"
      unique_id: grizzl_e_one_charge
